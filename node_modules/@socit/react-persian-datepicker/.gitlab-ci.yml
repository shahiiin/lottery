image: node:10.15.0

cache:
  paths:
    - node_modules/

before_script:
  - npm install

stages:
  # - test
  - deploy

# Test:
#   stage: test
#   only:
#     - master
#     - beta
#   script:
#     - npm test

Publish To NPM:
  stage: deploy
  only:
    - master
  script:
    - npm run build
    - echo '//registry.npmjs.org/:_authToken=${NPM_TOKEN}'>.npmrc
    - npm publish

Publish To NPM_BETA:
  stage: deploy
  only:
    - beta
  script:
    - npm run build
    - echo '//registry.npmjs.org/:_authToken=${NPM_TOKEN}'>.npmrc
    - npm publish --tag beta

pages:
  stage: deploy
  script:
    - mkdir .public
    - cp -r docs/. public
    - mv .public public
  artifacts:
    paths:
      - public
  only:
    - master
    - beta